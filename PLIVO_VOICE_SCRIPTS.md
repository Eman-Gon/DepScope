# Plivo Voice Scripts â€” DepScope

These are the scripts that Plivo's text-to-speech reads during phone calls.

---

## Script 1: Single Analysis Alert

Triggered when a single package analysis finds CRITICAL severity findings.

```
DepScope alert for lodash. Overall risk grade: D.

Critical finding: Prototype Pollution Vulnerability. Lodash versions before
4.17.21 are vulnerable to prototype pollution via the merge and zipObjectDeep
functions. Our recommendation: Upgrade to lodash 4.17.21 or later immediately.

There are 2 additional critical findings.

Press 1 to receive the full report via text message. Press 2 to dismiss.
```

---

## Script 2: Watchlist Scan Alert

Triggered after a scheduled scan when one or more repos receive an F grade.
Generated dynamically by Gemini (no markdown, plain spoken text).

```
DepScope watchlist alert. 2 of your monitored packages have received a failing
grade.

lodash received grade F. A critical prototype pollution vulnerability remains
unpatched and the package has had no maintainer activity in over 180 days.

event-stream received grade F. A known supply chain attack was injected in
version 3.3.6. The repository has been archived.

Immediate review and migration is strongly recommended.

Press 1 to receive the full report by text. Press 2 to dismiss.
```

---

## Script 3: Test Call

Used by `test-plivo.js` and the `/api/plivo/test-voice` endpoint.

```
This is a test call from DepScope dependency monitor.

DepScope Alert: 2 monitored packages have received a failing grade.

lodash, critical vulnerability: prototype pollution in versions before 4.17.21.
event-stream, critical: supply chain attack detected in version 3.3.6.

Immediate review is recommended.

Press 1 to receive the full report by text. Press 2 to dismiss.
```

---

## Script 4: DTMF Responses

After the user presses a digit:

**Press 1:**
```
Full report sent to your phone. Goodbye.
```

**Press 2:**
```
Dismissed. Goodbye.
```

**No input (timeout):**
```
Please press 1 or 2.
```

---

## SMS Templates

**Watchlist alert SMS (generated by Gemini):**
```
DepScope Alert: lodash, event-stream received grade F. Critical security
issues detected. Review immediately at your DepScope dashboard.
```

**Single analysis SMS (report link):**
```
DepScope Report: https://depscope.onrender.com/api/analyze/abc123/result
```

---

## Notes for Voice Script Generation

When Gemini generates voice scripts, the system prompt specifies:
- No markdown formatting (Plivo reads raw text)
- Under 30 seconds when read aloud
- Direct and urgent tone
- Name each failing package and its worst issue
- Always end with the press 1/press 2 prompt
